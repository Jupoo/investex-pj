$(document).ready(function(){let e=!0,t=new Date,a=new Date;function n(e,t){$("#"+e).text(t.toLocaleString())}function l(e){return("0"+e.getDate()).slice(-2)+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+e.getFullYear()}function r(){return{from_date:l(t),to_date:l(a),is_active:e}}function o(){$.ajax({url:"withdrawals-by-ps/",data:r()}).done(function(e){let t=$("#table-by-ps");t.html("");for(let a=0;a<e.length;a++){let n=document.createElement("div");n.className="table__line",a===e.length-1&&(n.className+=" table__footer");for(let t of["psTitle","inOut","balance"]){let l=document.createElement("div");l.className="table__cell",l.innerHTML=e[a][t].toLocaleString(),n.append(l)}t.append(n)}})}function c(){t=$("#start-date").datepicker("getDate"),a=$("#end-date").datepicker("getDate"),t&&a?(d(),o()):$("#table-by-ps").html("")}function d(){$.ajax({url:"report-data/",data:r()}).done(function(e){for(let[t,a]of Object.entries(e))for(let[e,l]of Object.entries(a)){let a=t+"_"+e,r=a.match(/([A-Z])/g);r&&r.forEach(function(e){a=a.replace(new RegExp(e),"_"+e.toLowerCase())}),n(a,l)}})}function s(e){let n=new Date;switch($("#start-date").prop("disabled",!0),$("#end-date").prop("disabled",!0),e){case"today":t=n,a=n;break;case"yesterday":let l=new Date;l.setDate(n.getDate()-1),t=l,a=l;break;case"week":let r=n.getDate()-n.getDay()+1;t=new Date(n.setDate(r)),a=new Date(n.setDate(r+6));break;case"month":let o=n.getFullYear(),d=n.getMonth();t=new Date(o,d,1),a=new Date(o,d+1,0);break;case"custom":return $("#start-date").prop("disabled",!1),$("#end-date").prop("disabled",!1),void c()}$("#start-date").datepicker("setDate",t),$("#end-date").datepicker("setDate",a),d(),o()}$(".js-range-date").on("click",function(e){let t=$(this).closest(".menu__item");s(t.attr("date-id")),$(".js-range-date").closest(".menu__item").removeClass("menu--active"),t.addClass("menu--active"),e.preventDefault()}),$.ajax({url:"withdrawal-ready-to-process/"}).done(function(e){n("js_rtp_count",e.rtpCount),n("js_rtp_count_cny",e.rtpCountCny),n("js_rtp_count_usd",e.rtpCountUsd)}),$.ajax({url:"mt-account-data/"}).done(function(e){n("js_trader_balance_cny",e.balanceCny),n("js_trader_balance_usd",e.balanceUsd)}),s("today"),$("#btn-show-all").on("click",function(t){let a=$(this);"true"===a.attr("data-enabled")?(a.text("Active only"),a.attr("data-enabled","false"),e=!1):(a.text("Show all"),a.attr("data-enabled","true"),e=!0),t.preventDefault(),o()}),$("#start-date").change(function(){c()}),$("#end-date").on("change",function(){c()})});